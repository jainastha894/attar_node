<style>
  .whatsapp-float {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 58px;
    height: 58px;
    border-radius: 9999px;
    background: #25D366;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.25);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
    z-index: 70;
    opacity: 0.95;
  }

  .whatsapp-float:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.3);
    opacity: 1;
  }

  .whatsapp-float img {
    width: 28px;
    height: 28px;
    filter: brightness(0) invert(1);
  }

  @media (max-width: 640px) {
    .whatsapp-float {
      width: 52px;
      height: 52px;
      bottom: 16px;
      right: 16px;
    }

    .whatsapp-float img {
      width: 24px;
      height: 24px;
    }
  }

  /* Mobile menu animation */
  .mobile-panel {
    transform-origin: top;
    transform: scaleY(0);
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    transition: transform .3s ease, opacity .3s ease, max-height .3s ease;
  }

  .mobile-panel.open {
    transform: scaleY(1);
    opacity: 1;
    max-height: 500px;
    /* adjust if menu is taller */
    pointer-events: auto;
  }
</style>

<!-- Navbar -->
<header class="fixed inset-x-0 top-0 z-50">
  <nav id="navbar" class="transition-all duration-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 sm:h-20 items-center justify-between">
        <!-- Brand -->
        <a href="/" class="flex items-center gap-2">
          <span class="text-xl sm:text-2xl cormorant tracking-wider text-white">
            <span class="text-[color:var(--gold)] font-semibold">ARJANMAL</span>
            <span class="font-light">ATTARCHAND</span>
          </span>
        </a>

        <!-- Desktop menu -->
        <div class="hidden md:flex items-center gap-8">
          <a href="/shop" id="nav-shop"
            class="nav-link text-sm tracking-widest uppercase text-gray-300 hover:text-[color:var(--gold)] transition">Shop</a>
          <a href="/about" id="nav-about"
            class="nav-link text-sm tracking-widest uppercase text-gray-300 hover:text-[color:var(--gold)] transition">About</a>
          <a href="/contact" id="nav-contact"
            class="nav-link text-sm tracking-widest uppercase text-gray-300 hover:text-[color:var(--gold)] transition">Contact</a>
        </div>

        <!-- Actions -->
        <div class="flex items-center gap-3">

          <!-- Mobile menu button -->
          <button id="menuToggle" class="md:hidden p-2 text-white hover:text-[color:var(--gold)]" aria-label="menu">
            <svg id="menuIconOpen" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <svg id="menuIconClose" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Mobile menu -->
      <!-- Mobile menu -->
      <div id="mobileMenu" class="md:hidden mobile-panel pb-6">
        <div class="mt-3 space-y-2 rounded-xl border border-white/10 bg-black/40 backdrop-blur p-4">
          <a href="/" target="" id="mobile-nav-home"
            class="mobile-nav-link block px-3 py-2 rounded-lg text-gray-300 hover:text-[color:var(--gold)] hover:bg-white/5">Home</a>
          <a href="/shop" target="" id="mobile-nav-shop"
            class="mobile-nav-link block px-3 py-2 rounded-lg text-gray-300 hover:text-[color:var(--gold)] hover:bg-white/5">Shop</a>
          <a href="/about" target="" id="mobile-nav-about"
            class="mobile-nav-link block px-3 py-2 rounded-lg text-gray-300 hover:text-[color:var(--gold)] hover:bg-white/5">About</a>
          <a href="/contact" target="" id="mobile-nav-contact"
            class="mobile-nav-link block px-3 py-2 rounded-lg text-gray-300 hover:text-[color:var(--gold)] hover:bg-white/5">Contact</a>
        </div>
      </div>

    </div>
    </div>
  </nav>
</header>

<script>
  // Highlight active navigation link based on current page
  (function () {
    const currentPath = window.location.pathname;

    // Don't highlight anything on home page
    if (currentPath === '/' || currentPath === '/index' || currentPath === '/index.html') {
      return;
    }

    // Map paths to navigation IDs
    const navMap = {
      '/shop': { desktop: 'nav-shop', mobile: 'mobile-nav-shop' },
      '/about': { desktop: 'nav-about', mobile: 'mobile-nav-about' },
      '/contact': { desktop: 'nav-contact', mobile: 'mobile-nav-contact' }
    };

    // Find matching navigation item
    for (const [path, ids] of Object.entries(navMap)) {
      if (currentPath.startsWith(path)) {
        // Highlight desktop nav
        const desktopNav = document.getElementById(ids.desktop);
        if (desktopNav) {
          desktopNav.classList.remove('text-gray-300');
          desktopNav.classList.add('text-white', 'font-semibold');
        }

        // Highlight mobile nav
        const mobileNav = document.getElementById(ids.mobile);
        if (mobileNav) {
          mobileNav.classList.remove('text-gray-300');
          mobileNav.classList.add('text-white', 'font-semibold');
        }
        break;
      }
    }
  })();

  // Global header behaviour (search, nav blur, mobile menu)
  document.addEventListener('DOMContentLoaded', function () {
    // ----- Search modal -----
    const searchBtn = document.getElementById('searchBtn');
    const searchModal = document.getElementById('searchModal');
    const closeSearchModal = document.getElementById('closeSearchModal');
    const closeSearchBtn = document.getElementById('closeSearchBtn');
    const searchForm = document.getElementById('searchForm');
    const headerSearchInput = document.getElementById('headerSearchInput');

    if (searchBtn && searchModal) {
      searchBtn.addEventListener('click', function () {
        searchModal.classList.remove('hidden');
        setTimeout(() => {
          if (headerSearchInput) headerSearchInput.focus();
        }, 100);
      });
    }

    if (closeSearchModal) {
      closeSearchModal.addEventListener('click', function () {
        searchModal.classList.add('hidden');
      });
    }

    if (closeSearchBtn) {
      closeSearchBtn.addEventListener('click', function () {
        searchModal.classList.add('hidden');
      });
    }

    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape' && searchModal && !searchModal.classList.contains('hidden')) {
        searchModal.classList.add('hidden');
      }
    });

    if (searchForm) {
      searchForm.addEventListener('submit', function (e) {
        e.preventDefault();
        const query = headerSearchInput ? headerSearchInput.value.trim() : '';
        if (query) {
          window.location.href = `/shop?q=${encodeURIComponent(query)}`;
        }
      });
    }

    // ----- Navbar blur on scroll -----
    const nav = document.getElementById('navbar');
    if (nav) {
      const applyNavBlur = () => {
        if (window.scrollY > 10) {
          nav.classList.add('nav-blur');
        } else {
          nav.classList.remove('nav-blur');
        }
      };

      applyNavBlur();
      window.addEventListener('scroll', applyNavBlur);
    }

    // ----- Mobile menu / hamburger -----
    const toggle = document.getElementById('menuToggle');
    const menu = document.getElementById('mobileMenu');
    const iconOpen = document.getElementById('menuIconOpen');
    const iconClose = document.getElementById('menuIconClose');

    if (toggle && menu) {
      const closeMenu = () => {
        menu.classList.remove('open');
        if (iconOpen) iconOpen.classList.remove('hidden');
        if (iconClose) iconClose.classList.add('hidden');
      };

      toggle.addEventListener('click', (e) => {
        e.stopPropagation(); // Prevent immediate close if bubbling
        const isOpen = menu.classList.contains('open');
        if (isOpen) {
          closeMenu();
        } else {
          menu.classList.add('open');
          if (iconOpen) iconOpen.classList.add('hidden');
          if (iconClose) iconClose.classList.remove('hidden');
        }
      });

      // Close mobile menu when a link is clicked
      menu.querySelectorAll('a').forEach(a => {
        a.addEventListener('click', () => {
          closeMenu();
        });
      });

      // Ensure correct state when resizing between mobile/desktop
      window.addEventListener('resize', () => {
        if (window.innerWidth >= 768) {
          closeMenu();
        }
      });

      // Close when clicking outside
      document.addEventListener('click', (e) => {
        if (menu.classList.contains('open') && !menu.contains(e.target) && !toggle.contains(e.target)) {
          closeMenu();
        }
      });
    } else {
      console.error("Mobile menu elements not found", { toggle, menu });
    }
  });
</script>