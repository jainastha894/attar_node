<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Arjanmal Attarchand</title>
    <link rel="stylesheet" href="/styles/admin.css">
    <script>
        // Apply sidebar state immediately to prevent flickering (using sessionStorage)
        (function() {
            try {
                var savedState = sessionStorage.getItem('sidebarMinimized');
                if (savedState === 'true' && document.head) {
                    var style = document.createElement('style');
                    style.id = 'sidebar-preload-state';
                    style.textContent = '#sidebar{width:80px!important}.main-content{margin-left:80px!important;width:calc(100vw - 80px)!important}';
                    document.head.appendChild(style);
                }
            } catch(e) {}
        })();
    </script>
</head>
<body>
    <div class="main-wrapper">
        <div id="dashboardPage" class="dashboard-container" style="display: flex;">
            <!-- Header Placeholder -->
            <div id="header-placeholder"><%- include('partials/header') %></div>

            <!-- Dashboard Body -->
            <div class="dashboard-body">
                <!-- Sidebar Placeholder -->
                <div id="sidebar-placeholder"><%- include('partials/sidebar') %></div>

                <!-- Main Content -->
                <main class="main-content">
                    <div class="content-header">
                        <h1>Profile</h1>
                        <p>Manage your account settings</p>
                    </div>
                    <div class="content-body">
                        <div class="profile-container">
                            <div class="profile-header">
                                <div class="profile-avatar-large" id="profileViewAvatar">
                                    <% if (admin && admin.profilePic) { %>
                                    <img id="profileViewAvatarImg" src="<%= admin.profilePic %>" alt="Profile" style="display: block; width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                                    <span id="profileViewAvatarText" style="display: none;">A</span>
                                    <% } else { %>
                                    <img id="profileViewAvatarImg" src="" alt="Profile" style="display: none;">
                                    <span id="profileViewAvatarText" style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; font-size: 48px; font-weight: bold; color: #000000; background: #FFD700; border-radius: 50%;"><%= admin && admin.fullName ? admin.fullName.charAt(0).toUpperCase() : 'A' %></span>
                                    <% } %>
                                </div>
                                <div class="profile-info">
                                    <h2 id="profileViewName"><%= admin && admin.fullName ? admin.fullName : 'Admin User' %></h2>
                                    <p id="profileViewRole"><%= admin && admin.role ? admin.role : 'Administrator' %></p>
                                    <button class="btn-edit-profile" onclick="window.location.href='/admin/profileSetting'">Edit Profile</button>
                                </div>
                            </div>

                            <div class="profile-section">
                                <h3>Personal Information</h3>
                                <div class="info-row">
                                    <div class="info-label">Username:</div>
                                    <div class="info-value" id="profileViewUserId"><%= admin && admin.username ? admin.username : 'ArjanAttarsAdmin' %></div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Full Name:</div>
                                    <div class="info-value" id="profileViewFullName"><%= admin && admin.fullName ? admin.fullName : 'Admin User' %></div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Email:</div>
                                    <div class="info-value" id="profileViewEmail"><%= admin && admin.email ? admin.email : '-' %></div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Phone:</div>
                                    <div class="info-value" id="profileViewPhone"><%= admin && admin.phone ? admin.phone : '-' %></div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Role:</div>
                                    <div class="info-value" id="profileViewRoleValue"><%= admin && admin.role ? admin.role : 'Administrator' %></div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Bio:</div>
                                    <div class="info-value" id="profileViewBio"><%= admin && admin.bio ? admin.bio : '-' %></div>
                                </div>
                            </div>

                            <div class="profile-section">
                                <h3>Account Settings</h3>
                                <div class="info-row">
                                    <div class="info-label">Account Status:</div>
                                    <div class="info-value">
                                        <span class="badge badge-active">Active</span>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Last Login:</div>
                                    <div class="info-value">Today</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Password:</div>
                                    <div class="info-value">
                                        <button class="btn-edit-profile" onclick="window.location.href='/admin/profileSetting'">Change Password</button>
                                    </div>
                                </div>
                            </div>

                            <div class="profile-section">
                                <h3>Statistics</h3>
                                <div class="info-row">
                                    <div class="info-label">Total Products Added:</div>
                                    <div class="info-value" id="totalProductsAdded"><%= totalproducts %></div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Active Products:</div>
                                    <div class="info-value" id="activeProductsCount"><%= activeproducts %></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>

            <!-- Footer Placeholder -->
            <div id="footer-placeholder"><%- include('partials/footer') %></div>
        </div>
    </div>
    <script src="/js/partials-loader.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/header-handler.js"></script>
   </body>
</html>
