<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product List - Arjanmal Attarchand</title>
    <link rel="stylesheet" href="/styles/admin.css">
</head>
<body>
    <div class="main-wrapper">
        <div id="dashboardPage" class="dashboard-container" style="display: flex;">
            <!-- Header Placeholder -->
            <div id="header-placeholder"><%- include('partials/header') %></div>

            <!-- Dashboard Body -->
            <div class="dashboard-body">
                <!-- Sidebar Placeholder -->
                <div id="sidebar-placeholder"><%- include('partials/sidebar') %></div>

                <!-- Main Content -->
                <main class="main-content">
                    <div class="content-header">
                        <h1>Product List</h1>
                        <p>Manage your products</p>
                    </div>
                    <div class="content-body">
                        <div class="product-list">
                            <div class="product-list-header">
                                <h2>All Products</h2>
                                <input type="text" class="search-box" placeholder="Search products..." id="searchProducts">
                            </div>
                            <table class="product-table">
                                <thead>
                                    <tr>
                                        <th>Image</th>
                                        <th>Name</th>
                                        <th>Industry</th>
                                        <th>Size</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="productTableBody">
                                    <tr>
                                        <td colspan="6" style="text-align: center; padding: 40px; color: #999;">No products added yet</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </main>
            </div>

            <!-- Footer Placeholder -->
            <div id="footer-placeholder"><%- include('partials/footer') %></div>
        </div>
    </div>
    <script src="js/partials-loader.js"></script>
    <script src="js/script.js"></script>
    <script src="js/header-handler.js"></script>
    <script>
        // Render Product List
        function renderProductList(searchTerm = '') {
            const productTableBody = document.getElementById('productTableBody');
            if (!productTableBody) return;
            
            const products = JSON.parse(localStorage.getItem('products') || '[]');
            const filteredProducts = products.filter(product => 
                product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                product.industry.toLowerCase().includes(searchTerm.toLowerCase())
            );

            if (filteredProducts.length === 0) {
                productTableBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #999;">
                            ${searchTerm ? 'No products found' : 'No products added yet'}
                        </td>
                    </tr>
                `;
                return;
            }

            productTableBody.innerHTML = filteredProducts.map(product => {
                let badges = '';
                if (product.active) badges += '<span class="badge badge-active">Active</span>';
                else badges += '<span class="badge badge-inactive">Inactive</span>';
                if (product.featured) badges += '<span class="badge badge-featured">Featured</span>';
                
                return `
                <tr>
                    <td>
                        <img src="${product.images[0]}" alt="${product.name}" class="product-image-cell">
                    </td>
                    <td>${product.name}</td>
                    <td>${product.industry}</td>
                    <td>${product.size}</td>
                    <td>${badges}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon btn-edit" onclick="editProduct(${product.id})">Edit</button>
                            <button class="btn-icon btn-delete" onclick="deleteProduct(${product.id})">Delete</button>
                        </div>
                    </td>
                </tr>
            `}).join('');
        }

        // Search functionality
        document.addEventListener('DOMContentLoaded', () => {
            renderProductList();
            const searchProducts = document.getElementById('searchProducts');
            if (searchProducts) {
                searchProducts.addEventListener('input', (e) => {
                    renderProductList(e.target.value);
                });
            }
        });

        // Product Actions
        window.editProduct = (id) => {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = 'position:fixed;top:80px;left:50%;transform:translateX(-50%);background:#FFF8DC;color:#8B4513;padding:16px 24px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:9999;';
            messageDiv.textContent = 'Edit functionality will be implemented';
            document.body.appendChild(messageDiv);
            setTimeout(() => messageDiv.remove(), 2000);
        };

        window.deleteProduct = (id) => {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = 'position:fixed;top:80px;left:50%;transform:translateX(-50%);background:white;padding:20px 28px;border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.2);z-index:9999;text-align:center;';
            messageDiv.innerHTML = `
                <p style="margin-bottom:16px;color:#333;font-size:15px;">Are you sure you want to delete this product?</p>
                <button id="confirmDelete" style="padding:8px 20px;background:#c62828;color:white;border:none;border-radius:4px;margin-right:8px;cursor:pointer;">Delete</button>
                <button id="cancelDelete" style="padding:8px 20px;background:#f0f0f0;color:#666;border:none;border-radius:4px;cursor:pointer;">Cancel</button>
            `;
            document.body.appendChild(messageDiv);
            
            document.getElementById('confirmDelete').onclick = () => {
                const products = JSON.parse(localStorage.getItem('products') || '[]');
                const updatedProducts = products.filter(p => p.id !== id);
                localStorage.setItem('products', JSON.stringify(updatedProducts));
                renderProductList();
                messageDiv.remove();
            };
            
            document.getElementById('cancelDelete').onclick = () => {
                messageDiv.remove();
            };
        };
    </script>
</body>
</html>
