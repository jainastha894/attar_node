<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Arjanmal Attarchand</title>
    <link rel="stylesheet" href="/styles/admin.css">
    <script>
        // Apply sidebar state immediately to prevent flickering (using sessionStorage)
        (function() {
            try {
                var savedState = sessionStorage.getItem('sidebarMinimized');
                if (savedState === 'true' && document.head) {
                    var style = document.createElement('style');
                    style.id = 'sidebar-preload-state';
                    style.textContent = '#sidebar{width:80px!important}.main-content{margin-left:80px!important;width:calc(100vw - 80px)!important}';
                    document.head.appendChild(style);
                }
            } catch(e) {}
        })();
    </script>
</head>
<body>

    <div class="main-wrapper">
        <div id="dashboardPage" class="dashboard-container" style="display: flex;">
            <!-- Header Placeholder -->
            <div id="header-placeholder">    <%- include('partials/header') %></div>

            <!-- Dashboard Body -->
            <div class="dashboard-body">
                <!-- Sidebar Placeholder -->
                 <div id="sidebar-placeholder"><%- include('partials/sidebar') %></div>
                

                <!-- Main Content -->
                <main class="main-content">
                    <div class="content-header">
                        <h1>Dashboard</h1>
                        <p>Overview of your products and leads</p>
                    </div>
                    <div class="content-body">
                        <!-- Products Section -->
                        <div style="margin-bottom: 40px;">
                            <h2 style="color: #FFD700; font-size: 24px; font-weight: 600; margin-bottom: 24px; text-align: center;">Products</h2>
                            <div style="width: 100%; height: 2px; background: linear-gradient(to right, transparent, #FFD700, transparent); margin-bottom: 24px;"></div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Total Products</h3>
                                    <div class="stat-value" id="totalProducts" style="text-align: center;"><%= totalproducts %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Active Products</h3>
                                    <div class="stat-value" id="activeProducts" style="text-align: center;"><%= activeproducts %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Featured Products</h3>
                                    <div class="stat-value" id="featuredProducts" style="text-align: center;"><%= featuredproducts %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Out of Stock</h3>
                                    <div class="stat-value" id="outOfStockProducts" style="text-align: center;"><%= outofstockproducts %></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Leads Section -->
                        <div style="margin-bottom: 40px;">
                            <h2 style="color: #FFD700; font-size: 24px; font-weight: 600; margin-bottom: 24px; text-align: center;">Leads</h2>
                            <div style="width: 100%; height: 2px; background: linear-gradient(to right, transparent, #FFD700, transparent); margin-bottom: 24px;"></div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Total Leads</h3>
                                    <div class="stat-value" id="totalLeads" style="text-align: center;"><%= totalLeads || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">New Leads</h3>
                                    <div class="stat-value" style="color: #4CAF50; text-align: center;"><%= newLeads || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Contacted</h3>
                                    <div class="stat-value" style="color: #2196F3; text-align: center;"><%= contactedLeads || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">In Progress</h3>
                                    <div class="stat-value" style="color: #FF9800; text-align: center;"><%= inProgressLeads || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Resolved</h3>
                                    <div class="stat-value" style="color: #9E9E9E; text-align: center;"><%= resolvedLeads || 0 %></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Product Enquiries Section -->
                        <div style="margin-bottom: 40px;">
                            <h2 style="color: #FFD700; font-size: 24px; font-weight: 600; margin-bottom: 24px; text-align: center;">Product Enquiries</h2>
                            <div style="width: 100%; height: 2px; background: linear-gradient(to right, transparent, #FFD700, transparent); margin-bottom: 24px;"></div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Total Enquiries</h3>
                                    <div class="stat-value" style="text-align: center;"><%= totalEnquiries || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Fragrance</h3>
                                    <div class="stat-value" style="text-align: center;"><%= fragranceEnquiries || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Food</h3>
                                    <div class="stat-value" style="text-align: center;"><%= foodEnquiries || 0 %></div>
                                </div>
                                <div class="stat-card">
                                    <h3 style="text-align: center;">Pharma</h3>
                                    <div class="stat-value" style="text-align: center;"><%= pharmaEnquiries || 0 %></div>
                                </div>
                            </div>
                            <% if (topProduct) { %>
                            <div style="margin-top: 24px; padding: 20px; background: #2a2a2a; border-radius: 12px; border: 2px solid #FFD700; text-align: center;">
                                <h3 style="color: #FFD700; font-size: 18px; margin-bottom: 12px;">Top Query Generated Product</h3>
                                <div style="color: #ffffff; font-size: 20px; font-weight: 600; margin-bottom: 8px;"><%= topProduct.name %></div>
                                <div style="color: #FFD700; font-size: 24px; font-weight: 700;"><%= topProduct.clicks %> Queries</div>
                            </div>
                            <% } %>
                        </div>
                    </div>
                </main>
            </div>

            <!-- Footer Placeholder -->
            <div id="footer-placeholder"><%- include('partials/footer') %></div>
        </div>
    </div>
    <script src="/js/partials-loader.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/header-handler.js"></script>

</body>
</html>