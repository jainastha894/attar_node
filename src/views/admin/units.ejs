<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modify Units - Arjanmal Attarchand</title>
    <link rel="stylesheet" href="/styles/admin.css">
    <script>
        // Apply sidebar state immediately to prevent flickering (using sessionStorage)
        (function() {
            try {
                var savedState = sessionStorage.getItem('sidebarMinimized');
                if (savedState === 'true' && document.head) {
                    var style = document.createElement('style');
                    style.id = 'sidebar-preload-state';
                    style.textContent = '#sidebar{width:80px!important}.main-content{margin-left:80px!important;width:calc(100vw - 80px)!important}';
                    document.head.appendChild(style);
                }
            } catch(e) {}
        })();
    </script>
</head>

<body>
    <div class="main-wrapper">
        <div id="dashboardPage" class="dashboard-container" style="display: flex;">
            <!-- Header Placeholder -->
            <div id="header-placeholder"><%- include('partials/header') %></div>

            <!-- Dashboard Body -->
            <div class="dashboard-body">
                <!-- Sidebar Placeholder -->
                <div id="sidebar-placeholder"><%- include('partials/sidebar') %></div>

                <!-- Main Content -->
                <main class="main-content">
                    <div class="content-header">
                        <h1>Modify Units</h1>
                        <p>Manage categories and attributes</p>
                    </div>

                    <div class="content-body">
                        <div class="units-grid">

                            <% for (const unitKey in units) { %>
                                <% if (unitKey !== 'jarBottleList') { %>
                                <div class="unit-card">

                                    <h3>
                                        <%= unitKey %>
                                    </h3>

                                    <ul class="unit-list" data-unit="<%= unitKey %>">
                                        <% units[unitKey].forEach(item=> { %>
                                            <li class="unit-item">
                                                <span class="unit-item-text">
                                                    <%= item %>
                                                </span>

                                                <form action="/admin/units/remove" method="POST"
                                                    style="display:inline;">
                                                    <input type="hidden" name="unitType" value="<%= unitKey %>">
                                                    <input type="hidden" name="value" value="<%= item %>">

                                                    <button type="submit" class="btn-remove">Ã—</button>
                                                </form>
                                            </li>
                                            <% }) %>
                                    </ul>


                                    <div class="add-unit-container">
                                        <form action="/admin/units/add" method="POST" class="add-unit-form">
                                            <input type="hidden" name="unitType" value="<%= unitKey %>">

                                            <!-- actual value -->
                                            <input type="text" name="newUnit" required>

                                            <button type="submit" class="btn-add">
                                                Add
                                            </button>
                                        </form>
                                    </div>

                                </div>
                                <% } %>
                                <% } %>

                        </div>
                    </div>
                </main>

            </div>

            <!-- Footer Placeholder -->
            <div id="footer-placeholder"><%- include('partials/footer') %></div>
        </div>
    </div>
    <script src="/js/partials-loader.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/header-handler.js"></script>
   
</body>

</html>